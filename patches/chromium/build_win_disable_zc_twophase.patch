From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: deepak1556 <hop2deep@gmail.com>
Date: Tue, 16 Jul 2019 14:38:52 -0700
Subject: build_win_disable_zc_twophase.patch

Temporarily disable /Zc:twoPhase when libcxx is not used on
Windows. This is to workaround the bug in crbug.com/969698#c10
until fixes have landed in upstream.

diff --git a/build/config/win/BUILD.gn b/build/config/win/BUILD.gn
index b050343a66b7783a73b0a5305f3552adf0cc742c..e33dcf6ab02238e149347fb40ea54cc27944240b 100644
--- a/build/config/win/BUILD.gn
+++ b/build/config/win/BUILD.gn
@@ -2,6 +2,7 @@
 # Use of this source code is governed by a BSD-style license that can be
 # found in the LICENSE file.
 
+import("//build/config/c++/c++.gni")
 import("//build/config/chrome_build.gni")
 import("//build/config/clang/clang.gni")
 import("//build/config/compiler/compiler.gni")
@@ -63,7 +64,8 @@ config("compiler") {
     "/utf-8",  # Assume UTF-8 by default to avoid code page dependencies.
   ]
 
-  if (is_clang) {
+  if (use_custom_libcxx) {
+    # Work around crbug.com/969698#c6, bug in MSSTL <xxatomic>.
     cflags += [ "/Zc:twoPhase" ]
   }
 
